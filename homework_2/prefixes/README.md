Code available at http://jsfiddle.net/DPnGk/